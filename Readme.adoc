= Learning test for HAL browser

== Abstract
This project shows how to make beautiful REST API with documentation and quick testing with HAL Browser.

== Spring Data REST HAL Browser
Spring package spring-data-rest-hal-browser comes with lot of things out of the box, but there are some crucial things that are missing.

=== Problems with Spring Data REST and Spring Data REST HAL Browser:
. Spring Data REST HAL Browser works only with Spring Data REST.
. Spring Data REST has problem with POST-ing invalid data. Instead of returning Bed Request HTTP status it returns Internal error (HTTP Status 500).
. Spring Data REST also doesn't support extending autogenerated documentation with custom controllers.

When adding up all problems Spring Data REST and Spring Data REST HAL Browser become unusable in real world projects, but they do make good reference when looklin how to make usable REST API with HAL links.

== Explanation of shortcuts

* HAL - Hypertext Application Language - https://en.wikipedia.org/wiki/Hypertext_Application_Language[HAL Wikipedia], https://phlyrestfully.readthedocs.io/en/latest/index.html[HAL Primer]
* ALPS - Application-Level Profile Semantics - https://en.wikipedia.org/wiki/Application-Level_Profile_Semantics_(ALPS)[ALPS Wikipedia]
* CURIE - Compact URI - https://en.wikipedia.org/wiki/CURIE[CURIE Wikipedia]

== Better way
HAL Browser should be outside of a project and provided by Docker image. That way you can target localhost while developing REST API for quick check, and then later you can target your project in separate docker container.

Project should link to API documentation created with Spring REST Docs library.

== Current solution
For now I decided to use simplest solution so I copied https://github.com/mikekelly/hal-browser[HAL Browser] to static resources and created controller that redirects to static index.html.

Now HAL Browser can be accessed at http://localhost:8080/browser/index.html

NOTE:  We could probably extract static files and serve them with nginx, but for now this is good enough.

= Running application

First you need to build application with:
[source,bash]
----
./gradlew clean build
----
Then you can star application with:
[source,bash]
----
java -jar build/libs/spring-hal-browser-learning-test-0.0.1-SNAPSHOT.jar
----

== Debugging build
[source,bash]
----
./gradlew -Dorg.gradle.debug=true -Penv=dev clean build
----

== API Documentation

API Documentation is created with Spring REST Docs library and it is packaged with application.

When running application you can access API documentation at http://localhost:8080/docs/api-guide.html

== User Guide

User Guide is created with Spring REST Docs library and it is packaged with application.

When running application you can access API documentation at http://localhost:8080/docs/user-guide.html

== H2 Console

When running in development mode H2 database is used and you can access with H2 Console http://localhost:8080/h2-console/

== Development workflow

When new endpoint is being developed you should add objects in this order.

. ControllerSpecification (groovy)
. Controller/Method (java)
. ServiceSpecification - if needed (groovy)
. Service - if needed (java)
. RepositorySpecification - if needed (groovy)
. Repository - if needed (java)
. User Guide documentation (adoc)
. Method Documentation (java)

== Profiles

There are two profiles. DEFAULT profile is default profile that is using H2 database and DEV profile that is using
PostgreSQL database.

DEV profile is using liquibase to version database and for DEFAULT profile database is created by hibernate.

=== Default profile
Building package:
[source,bash]
----
./gradlew clean build
----

=== Dev profile
Building package:
[source,bash]
----
./gradlew -Penv=dev clean build
----